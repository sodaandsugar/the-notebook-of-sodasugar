# Lec 14: 语言分析、自动机
## 1. 语言分析
### 1. 1 短语结构语法（Phrase Structure Grammar）
1. 短语结构语法是一个四元组 $G=<V,S,v_0,⊢>$
   * $V$ ：字符集
   * $S ⊆ V$ ：终结符
   * $N=V-S$ ：非终结符
   * $⊢$ ：产生式关系（二元关系），$w ⊢w'$ 表示w可以替换成w′，分别称为左部和右部
   * $v_0∈ N$ ：初始符（句子符），是替换的起点
2. $V^*$ 上的二元关系
   * 直接导出关系( $x→y$ )
     * $x=awb$，$y=aw'b$，且$w ⊢w′$是产生式，$a,b ∈ V^*$
     * 导出的结果称作符合语法 $G$ 的句子
   * $→$ 关系的传递闭包 $→ ∞$ (和划分中 $t(→)$)
   * $w ∈ S^*$ 是语法正确的句子 $↔$ $v_0 → ^∞w$
3. 语言
   * 利用语法 $G$ 产生的所有的正确构造的句子的集合称作 $G$ 的语言，记作 $L(G)$
     * 不同的语法可能产生不同的语言，也可能产生相同的语言
### 1. 2 导出树（Derivation Tree）
* 用多元有向树表示语言导出过程
    * 起始符 $v_0$ 作为树根
    * 每个子树的树根是某个生成式的左部
    * 子节点分别是生产式右部包含的符号
    * 适合所有产生式的左部仅有一个非终结符情形
### 1. 3 语法分类
* 0型语言
  * 对产生式没有任何约束
  * 无限制语法
* 1型语言
  * 所有产生式形如 $aAb ⊢ acb$ ，$A$ 是非终结符，$a,b,c$ 是任意串，$c$ 不是空串
* 2型语言
  * 所有产生式形如 $A ⊢ b$，$A$ 是非终结符，$b$ 是任意串
* 3型语言
  * 所有产生式形如 $A ⊢ b$，$A$ 是非终结符，$b$ 最多有一个非终结符且只能在最右端

> 注：L3 ⊂ L2 ⊂ L1 ⊂ L0

* 短语结构语法(PSG)
  * 0型语言
  * 产生递归可枚举语言
  * 被图灵机识别
* 上下文相关语法（CSG: Context Sensitive Grammar）
  * 1型语言
  * 被线性有界自动机识别
* 上下文无关语法（CFG: Context Free Grammar）
  * 2型语言
  * 被下推自动机识别
  * 为大多数程序设计语言的语法提供理论基础
* 正则语法（RG: Regular Grammar）
  * 3型语言
  * 被有限状态自动机识别
  * 可用正则表达式表示
  * 通常用来定义检索模式或者程序设计语言中的词法结构
### 1. 4 BNF（Backus-Naur Form）范式
* 形式
  * $::=$ 定义为
  * $|$ 或
  * $<>$ 用于区分非终结符
* BNF可以表示2、3型语法（上下文无关语法、正则语法）
  * BNF产生式左部仅有一个非终结符
  * 相同左部的产生式合并用 $|$ 隔开
  * 非终结符用 $<>$ 标记
* 正规：递归出现一次且在最右
  * 3型语法中的递归产生式都是正规的
* 扩展BNF
  * $[\,]$ 可选项
  * $\{\,\}$ 重复项
    * <标识符>::= <字母> { <字母> | <数字>}
  * $“\,”$ 区分单个符号的终结符
    * <语句序列>::=<语句> { “ ； ” <语句> }
  * 有时也用粗体字表示终结符，非终结符不加尖括号，可读性更好
### 1. 5 语法图（Syntax Diagram）
* 用方框表示非终结符
* 用圆表示终结符
* 用带箭头线表示连接关系和连接顺序
### 1. 6 正则集合与正则语法
* $S$ 是有限集合，$L ⊆ S$，则 $L$是 正则集合 $↔$ 对某个正则语法 $G$ 有 $L=L(G)$
* 主导图（master diagram）
  * 将 $G$ 的语法组合为一个大图，其中仅包含 $v_0$ 和终结符
  * 语法图中终结符对应正则表达式中的终结符
  * 串联子图对应表达式 $a_1a_2$
  * 并联子图对应表达式 $a_1|a_2$
  * 回路子图对应子表达式 $a^*$
## 2. 自动机
### 2. 1 有限状态机（Finite State Machine）
* FSM是一个五元组 $M(A,S,Y,s_0,F)$
    * $A$：输入字符串的字母表
    * $S$：机器的有限状态集合
    * $Y⊆S$：被称作“接受” 的一些状态
    * $s_0∈S$：初始状态
    * $F:S×A → S$：状态转移函数，指明在某个状态下接受输入字符所引起的状态变迁
### 2. 2 状态图
* 状态图 $D=D(M)$ 是边带标记的有向图
    * 节点为状态，转移函数决定边的走向和标记
    * 接受状态用双圈表示
    * 如果 $F(s_i,a)=s_k$，则从节点$s_i$做标记为a的有向边到节点$s_k$
    * 初始状态$s_0$用一个特殊的无源箭头标识
### 2. 3 语言识别
* 定义：$w= a_1a_2 … a_m ∈ A^∗$ 确定了一个状态序列 $s_0,s_1,...,s_m$ ，其中$F(s_{i-1},a_i)=s_i$ ,这相当于确定了拟路径$P=(s_0,a_1,s_1,a_2,s_2,...,a_m,s_m)$，若$s_m∈Y$ ，则称M识别w
* 正则语言和有限状态机
  * **Kleen定理**：字母表 $A$ 上的形式语言 $L$ 是正则的 ↔ 存在一个有限状态机M使得$L=L(M)$.
  * **泵引理（Pumping）**：所有长度超过状态数目的接受串 $w$ 都可以表示成 $w=xyz$ 的形式，且 $xy^mz$ 都会被 $M$ 接受.
### 2. 4 带输出的状态机
* 在有限状态机 M(A,S,Y,s_0,F)的基础上
  * 去掉接受状态集合Y
  * 增加输出字符的有限集合Z
  * 增加输出函数 $G:S×A→Z$ ,在状态转移的同时输出一个字符
