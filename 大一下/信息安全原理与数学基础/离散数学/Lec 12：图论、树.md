# Lec 12：图论、树
## 1 图论
### 1. 1 图（graph）
#### 1. 1. 1 基本概念
* 由结点和联结结点的边所构成的离散结构，记作 $G =< V, E >$
  * 结点（vertex）集 $V$：非空集合
  * 边（edge）集 $E$：多重集合（集合中可能存在相同元素，元素附带一个重数的属性）
* 边的分类
  * 有向边（directed edge）
    * 用结点的二元有序组表示，第一分量称作起点，第二分量称作终点
  * 无向边（indirected edge）
    * 用结点的两元素多重集表示
    * 允许无向环（loop）
    * 无向边的端点称作邻接（adjacent）结点
  * 重边（multiple edge）
    * $E$ 中重数大于1的边
* 结点的度（degree）
  * 端点 $v$ 的度 $d(v)$ 定义为关联端点 $v$ 的边的数目
  * 有向图中，度分为出度（out-degree）和入度（in-degree），$d(v) = d^+(v) + d^-(v)$
  * 一度的顶点称为悬挂点（pendant node）
  * 度的性质
    * 所有端点的度的总和为偶数，而且是边数目的两倍
    * 有向图中出度的总和等于入度的总和
    * 奇数度结点必为偶数个
    * 自然数序列 $(a_1, a_2, … , a_n)$ 是某个图的度序列当且仅当序列中所有数的总和为偶数
#### 1. 1. 2 图的分类与相互关系
* 有限图：$V，E$ 都是有限集，否则称为无限图
* 重图（multigraph）：$E$ 中至少有一个元素重数大于1
* 单图：每条边的重数都等于1
* 简单图（simple graph）：无环和重边的无向图
* 完全图（complete graph）：任何两个不同结点间都有边关联的简单图，记作 $K_n$
* 孤立结点（isolated vertex）：不是任何边的端点的结点
* 零图：仅由孤立结点构成的图（$E = ∅$）
* 正则图（regular graph）
  * 所有顶点的度均相同的图称为正则图，按照顶点的度数 $k$ 称作 k-正则图
  * $K_n$ 是 (n-1)-正则图
* 赋权图
  * $G =< V, E, f, g >$
  * 结点权函数：$f：V → W$
  * 边权函数：$g：E → W$
  * $W$ 可以是任何集合，常为实数的子集
* 子图（subgraph）
  * 若 $V_1 ⊆ V_2， E_1 ⊆ E_2$，则 $G_1$ 是 $G_2$ 的子图
  * 若 $G1 ≠ G2$，则 $G_1$ 是 $G_2$ 的真子图
* 生成子图（spanning subgraph）：$G_1$ 是 $G_2$ 的子图且 $V_1 = V_2$
* 补图：$V1 = V2， E1 ∩ E2 = ∅$，$< V1, E1 ∪ E2 >$ 是完全图
* 图的同构（isomorphic）：$|V_1| = |V_2|， |E_1| = |E_2|$
### 1. 2 连通问题
#### 1. 2. 1 基本概念
* 拟路径（pseudo-path）
  * 顶点 $v_1$ 到 $v_m$ 的拟路径：$v_1, e_1, v_2, e_2, v_3, … , v_{m-1},e_{m-1}, v_m$
  * 其中 $e_i =< v_i, v_{i+1} > （或者 \{v_i, v_{i+1}\}）$
  * 拟路径中的边数目称作拟路径的长度
* 路径（walk）：拟路径中的边各不相同
* 通路（path）：路径中的顶点各不相同
* 闭路径：$v_1 = v_m$ 的路径
* 回路：$v_1 = v_m$ 的通路
* 路径和通路定理
  * 在有 $n$ 个顶点的图 $G$ 中，如果有顶点 $u$ 到 $v$ 的拟路径，那么 $u$ 到 $v$ 必有路径，并且必有长度不大于 $n-1$ 的通路
* 闭路径和回路定理
  * 在有 $n$ 个顶点的图 $G$ 中，如果有顶点 $v$ 到 $v$ 的拟路径，那么必定有一条从 $v$ 到 $v$ 的长度不大于 $n$ 的回路
* 图的连通性
  * 连通的无向图（connected）：无向图中任意两个顶点都是可达的
  * 强连通的有向图：有向图中任意两个顶点都是互相可达的
  * 单向连通的有向图：任意两个顶点，至少从一个顶点到另一个顶点是可达的
  * 弱连通的有向图：将有向图看作无向图时是连通的
* 连通分支（connected component）
  * 图G的连通子图G’，而且G’ 不是任何其它连通子图的真子图（最大性）
#### 1. 2. 2 欧拉图与哈密顿图
* 欧拉图（Euler graph）
  * 图 $G$ 上有一条经过所有顶点、所有边的闭路径（边不重复，允许顶点重复）
  * 充要条件
    * 无向图：$G$ 连通，所有顶点的度都是偶数
    * 有向图：$G$ 弱连通，每个顶点的出度与入度相等
* 欧拉路径（Euler walk）
  * 图 $G$ 上有一条经过所有顶点、所有边的路径（边不重复，允许顶点重复）
  * 充要条件
    * 无向图：$G$ 连通，恰有两个顶点的度是奇数
    * 有向图：$G$ 弱连通，恰有两个顶点的出度与入度不相等，其中一个出度比入度多1，另一个入度比出度多
* 哈密顿图（Hamilton graph）
  * 图 $G$ 上有一条经过所有顶点的回路（不要求经过所有边，也称作哈密顿回路）
  * 判定定理（充分非必要）
    * 如果 $G$ 的每一对顶点度数之和不小于 $n$ 且$n ≥ 3$，则 $G$ 为哈密顿图
* 哈密顿通路（Hamilton path）
  * 图 $G$ 上有一条经过所有顶点的通路（非回路）
  * 判定定理（充分非必要）
    * 如果具有 $n$ 个顶点的图 $G$ 的每一对顶点的度数之和都不小于 $n-1$，那么 $G$ 中有一条哈密顿通路
#### 1. 2. 3 矩阵
* 邻接矩阵（adjacency matrix）
  * 对于无重边的有向图的 $|V|×|V|$ 矩阵，表示顶点的邻接关系
    * 当 $< vi, vj >∈ E$ 时 $a_{ij}=1$
    * 当 $< vi, vj >∉ E$ 时 $a_{ij}=0$
  * 出度对应行的和，入度：对应列的和
  * $A^L$ 中每个分量 $a_{ij}^{(L)}$ 为 $G$ 中顶点 $v_i$ 到 $v_j$ 的长度为 $L$ 的拟路径条数
* 关联矩阵（简单无向图）
  * 表示顶点和边的关联关系，$n*m$ 矩阵
  * 通过矩阵的秩来判定图的连通分支个数
* 路径矩阵（walk matrix）
  * 对于图 $G =< V, E >$ 的邻接矩阵 $A$，定义 $A^{(m)} = A ∧ A ∧ ⋯∧ A$
  * 路径矩阵 $B = A ∨ A^{(2)} ∨ A^{(3)} ∨ ⋯ ∨ A^{(|V|)}$
  * $B$ 的每个分量 $b_{ij}$ 表示 $v_i$ 到 $v_j$是否有路径
* 可达性矩阵
  * $P = I ∨ B$，$I$ 是 $n*n$ 的单位矩阵
  * 加上顶点的自身可达性
### 1. 3 二分图（bipartite graph）
#### 1. 3. 1 基本概念
* 对于无向图 $G =< V, E >$，若有非空集合 $X,Y$ 满足 $X ∪ Y = V, X ∩ Y = ∅$，且$∀{v_i, v_j} ∈ E$，都有 $v_i ∈ X ∧ v_j ∈ Y$ 或 $v_i ∈ Y ∧ v_j ∈ X$，则可用 $G =< X, E, Y >$ 表示二分图
* 完全二分图（complete bipartite graph）
  * $X,Y$ 中任意两个顶点之间都有边，记作 $K_{|X|,|Y|}$
* 二分图的等价条件
  * G至少要有两个顶点，而且G中所有回路的长度都是偶数
* 匹配（matching）
  * $M$ 中的任意两条边都没有公共端点
* 最大匹配（maximal matching）
  * 边数最多的匹配
* 完全匹配（perfect matching）
  * $U$ 中所有的顶点都出现在匹配 $M$ 中
* 完全匹配
  * $M$ 既是U-完全匹配，又是V-完全匹配
#### 1. 3. 2 最大匹配：匈牙利算法
1. 任意取一个匹配 $M$（可以是空集或者只有一条边）
2. 令 $S$ 是非饱和点（尚未匹配的点）的集合
3. 如果 $S = ∅$，则 $M$ 已经是最大匹配
4. 从 $S$ 中取出一个非饱和点 $u_0$ 作为起点，从此起点走交错路（交替属于M和非M的边构成极大无重复点通路或回路）$P$
5. 如果 $P$ 是一个增广路（ $P$ 的终点也是非饱和点），则令 $M = M ⊕ P = (M −P) ∪ (P − M)$
6. 如果 $P$ 不是增广路，则从 $S$ 中去掉 $u_0$	，再跳转到第3步
### 1. 4 平面图（planar graph）
* 可以在一个平面上图示出来且各边仅在顶点处相交的无向图
* $K_5$ 是顶点数最少的非平面图
* $K_{3,3}$ 是边数最少的非平面图
* 同胚操作：在原图的边上增加或者删除二度结点
* 平面图等价条件
  * $G$ 或者 $G$ 的子图作任何同胚操作后得到的图均不能以 $K_5$  和 $K_{3,3}$ 为子图

## 2 树
### 2. 1 基本概念
* 树（tree）：连通无回路的无向图
* 树叶（leaf）：树中的悬挂点
* 分支点（branched node）：非树叶节点
* 空树（null tree）：仅有单个孤立节点的树
* 森林（forest）：每个连通分支都是树的图
### 2. 2 性质
* 树是森林
* 树是简单图、二分图、平面图
* 树的顶点数比边数多1
* 任意两个不同顶点之间仅有一条通路
### 2. 3 特殊树
* 生成树（spanning tree）
  * 如果图 $T$ 是 $G$ 的生成子图且 $T$ 是树，则称 $T$ 是 $G$ 的生成树
  * 任意连通图 $G$ 都至少有一颗生成树
* 根树（rooted tree）
  * 一个孤立节点 $v_0$ 是根树，$v_0$ 称为树根
  * 如果 $T_1,T_2,…,T_k$ 是根树，其树根分别是 $v_1,v_2,…,v_k$，则：
    * $V = V (T_1) ∪ V (T_2) ∪ ⋯ ∪ V (T_k) ∪ \{v_0\}$
    * $E = E (T_1)∪ E (T_2) ∪ ⋯ ∪ E (T_k) ∪ \{v_0, v_1\} ∪ \{v_0, v_2\} ∪ ⋯ ∪ \{v_0, v_k\}$
    * $T =< V, E>$也是根树， $v_0$ 称为树根
    * $T_n$ 称为 $T$ 的子树（subtree），树根称为父节点（parent）
    * 子树的树根称为子节点（child）
    * $v_1,v_2,…,v_k$互称兄弟节点（sibling）
    * 根树中的每个节点都是某个子树的根
  * 每个节点都至多有 $n$ 个子节点的根树称作 $n$ 元树
  * 对于子节点规定了次序的 $n$ 元树称作 $n$ 元有序树
* 二元有序树
  * 最常用的 $n$ 元树是二元树（左右子节点）
  * 二元有序树可以表示任何 $n$ 元有序树
  * 左子节点表示第一个子节点
  * 右子节点表示下一个兄弟节点